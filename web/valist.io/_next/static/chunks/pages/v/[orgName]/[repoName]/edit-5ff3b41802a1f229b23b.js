(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[460],{84444:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(809),s=n.n(r),a=n(92447),i=n(67294),c=n(14485);function o(e){var t=(0,i.useContext)(c.Z),n=(0,i.useState)(!1),r=n[0],o=n[1];return(0,i.useEffect)((function(){(0,a.Z)(s().mark((function n(){return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t||"0x0"===t.defaultAccount||!e){n.next=12;break}return n.prev=1,n.t0=o,n.next=5,t.isOrgAdmin(e,t.defaultAccount);case 5:n.t1=n.sent,(0,n.t0)(n.t1),n.next=12;break;case 9:n.prev=9,n.t2=n.catch(1),o(!1);case 12:case"end":return n.stop()}}),n,null,[[1,9]])})))()}),[t,e]),r}},35686:function(e,t,n){"use strict";n.r(t),n.d(t,{EditProjectPage:function(){return j},default:function(){return w}});var r=n(85893),s=n(809),a=n.n(s),i=n(92447),c=n(67294),o=n(11163),l=n(41664),u=n(14485),d=n(73669),p=n(84444),m=function(e){var t=(0,c.useState)(""),n=t[0],s=t[1],a=(0,c.useState)(""),i=a[0],o=a[1],l=(0,c.useState)(""),u=l[0],d=l[1],m=(0,c.useState)(e.meta.projectType),x=m[0],h=m[1],f=(0,p.Z)(e.orgName);return(0,c.useEffect)((function(){e.meta.homepage&&s(e.meta.homepage),e.meta.repository&&o(e.meta.repository),d(e.meta.description),h(e.meta.projectType)}),[e.meta]),(0,r.jsx)("div",{className:"px-4 py-5 sm:rounded-lg sm:p-6",children:(0,r.jsxs)("div",{className:"md:grid md:grid-cols-3 md:gap-6",children:[(0,r.jsxs)("div",{className:"md:col-span-1",children:[(0,r.jsx)("h3",{className:"text-lg font-medium leading-6 text-gray-900",children:"Metadata"}),(0,r.jsx)("p",{className:"mt-1 text-sm leading-5 text-gray-500",children:"This information will be displayed publicly so be careful what you share."})]}),(0,r.jsx)("div",{className:"mt-5 md:mt-0 md:col-span-2",children:(0,r.jsxs)("form",{className:"grid grid-cols-1 gap-y-6 sm:grid-cols-2 sm:gap-x-8",children:[(0,r.jsxs)("div",{className:"sm:col-span-2",children:[(0,r.jsx)("label",{htmlFor:"ProjectHomepage",className:"block text-sm font-medium leading-5 text-gray-700",children:"Homepage"}),(0,r.jsx)("div",{className:"mt-1 relative rounded-md shadow-sm",children:(0,r.jsx)("input",{disabled:!f,value:n,type:"text",onChange:function(e){return s(e.target.value)},id:"ProjectHomepage",className:"form-input block w-full sm:text-sm sm:leading-5 transition ease-in-outduration-150"})})]}),(0,r.jsxs)("div",{className:"sm:col-span-2",children:[(0,r.jsx)("label",{htmlFor:"ProjectRepository",className:"block text-sm font-medium leading-5 text-gray-700",children:"Repository"}),(0,r.jsx)("div",{className:"mt-1 relative rounded-md shadow-sm",children:(0,r.jsx)("input",{disabled:!f,value:i,type:"text",onChange:function(e){return o(e.target.value)},id:"ProjectRepository",className:"form-input block w-full sm:text-sm sm:leading-5 transition ease-in-out duration-150"})})]}),!e.hasReleased&&(0,r.jsx)("div",{className:"sm:col-span-2",children:(0,r.jsxs)("label",{className:"block",children:[(0,r.jsx)("span",{className:"text-gray-700",children:"Project Type"}),(0,r.jsxs)("select",{value:x,onChange:function(e){return h(e.target.value)},className:"form-select block w-full mt-1",children:[(0,r.jsx)("option",{value:"binary",children:"Binary"}),(0,r.jsx)("option",{value:"go",children:"Go"}),(0,r.jsx)("option",{value:"rust",children:"Rust"}),(0,r.jsx)("option",{value:"c++",children:"C++"}),(0,r.jsx)("option",{value:"node",children:"NodeJS"}),(0,r.jsx)("option",{value:"python",children:"Python"}),(0,r.jsx)("option",{value:"docker",children:"Docker"}),(0,r.jsx)("option",{value:"static",children:"Static"})]})]})}),(0,r.jsxs)("div",{className:"sm:col-span-2",children:[(0,r.jsx)("label",{htmlFor:"ProjectDescription",className:"block text-sm font-medium leading-5 text-gray-700",children:"Description"}),(0,r.jsx)("div",{className:"mt-1 relative rounded-md shadow-sm",children:(0,r.jsx)("textarea",{disabled:!f,value:u,onChange:function(e){return d(e.target.value)},id:"ProjectDescription",className:"h-20 form-input block w-full sm:text-sm sm:leading-5 transition ease-in-out duration-150"})})]}),(0,r.jsx)("div",{className:"sm:col-span-2",children:f?(0,r.jsx)("span",{className:"w-full inline-flex rounded-md shadow-sm",children:(0,r.jsx)("button",{onClick:function(){x&&n&&i&&u?e.setRepoMeta({name:e.repoName,homepage:n,repository:i,description:u,projectType:x}):alert("Missing metadata")},value:"Submit",type:"button",className:"w-full inline-flex items-center justify-center px-6 py-3 border border-transparent text-base leading-6 font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-500 focus:outline-none focus:border-indigo-700 focus:shadow-outline-indigo active:bg-indigo-700 transition ease-in-out duration-150",children:"Update Metadata"})}):(0,r.jsx)("p",{className:"font-medium text-sm",children:"Cannot modify repo metadata, currently not an orgAdmin role."})})]})})]})})},x=function(e){var t=(0,c.useState)("0"),n=t[0],s=t[1];return(0,c.useEffect)((function(){s("".concat(e.threshold))}),[e.threshold]),(0,r.jsx)("div",{className:"px-4 py-5 sm:rounded-lg sm:p-6",children:(0,r.jsxs)("div",{className:"md:grid md:grid-cols-3 md:gap-6",children:[(0,r.jsxs)("div",{className:"md:col-span-1",children:[(0,r.jsx)("h3",{className:"text-lg font-medium leading-6 text-gray-900",children:"Multi-factor"}),(0,r.jsx)("p",{className:"mt-1 text-sm leading-5 text-gray-500",children:"This sets the amount of votes required to add / remove keys and publish new releases. Three or more members are required to enable multi-factor voting."})]}),(0,r.jsx)("div",{className:"mt-5 md:mt-0 md:col-span-2",children:(0,r.jsxs)("form",{className:"grid grid-cols-1 gap-y-6 sm:grid-cols-2 sm:gap-x-8",children:[(0,r.jsxs)("div",{className:"sm:col-span-2",children:[(0,r.jsx)("label",{htmlFor:"VoteThreshold",className:"block text-sm font-medium leading-5 text-gray-700",children:"Voting Threshold"}),(0,r.jsx)("div",{className:"mt-1 relative rounded-md shadow-sm",children:(0,r.jsx)("input",{value:n,type:"number",onChange:function(e){return s(e.target.value)},required:!0,id:"VoteThreshold",className:"form-input block w-full sm:text-sm sm:leading-5 transition ease-in-out duration-150"})})]}),(0,r.jsx)("div",{className:"sm:col-span-2",children:(0,r.jsx)("span",{className:"w-full inline-flex rounded-md shadow-sm",children:(0,r.jsx)("button",{onClick:function(){return e.voteThreshold(n)},value:"Submit",type:"button",className:"w-full inline-flex items-center justify-center px-6 py-3 border border-transparent text-base leading-6 font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-500 focus:outline-none focus:border-indigo-700 focus:shadow-outline-indigo active:bg-indigo-700 transition ease-in-out duration-150",children:"Update Threshold"})})})]})})]})})},h=n(93985),f=n(53142),v=n(19186),g=n(42727),j=function(){var e=(0,c.useContext)(u.Z),t=(0,o.useRouter)(),n="".concat(t.query.orgName),s="".concat(t.query.repoName),p=(0,c.useState)(!1),j=p[0],w=p[1],N=(0,c.useState)(),y=N[0],b=N[1],k=(0,c.useState)(),R=k[0],P=k[1],T=(0,c.useState)(!0),Z=T[0],S=T[1],C=(0,c.useState)([]),_=C[0],E=C[1],M=(0,c.useState)([]),D=M[0],K=M[1],A=(0,c.useState)([]),q=A[0],H=A[1],V=(0,c.useState)([]),F=V[0],O=V[1],I=(0,c.useState)([]),U=I[0],X=I[1],B=function(){var t=(0,i.Z)(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Promise.all([e.getRepository(n,s).then(P),e.getRepoDevs(n,s).then(E),e.getRepoEvents(n,s).then(K),e.getPendingRepoDevs(n,s).then(H),e.getPendingRepoThresholds(n,s).then(O),e.getPendingReleases(n,s).then(X),e.repoHasReleased(n,s).then(S)]));case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),G=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,w(!0),e.next=4,B();case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),b(e.t0);case 9:return e.prev=9,w(!1),e.finish(9);case 12:case"end":return e.stop()}}),e,null,[[0,6,9,12]])})));return function(){return e.apply(this,arguments)}}(),J=function(){var t=(0,i.Z)(a().mark((function t(r){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,w(!0),t.next=4,e.setRepoMeta(n,s,r,e.defaultAccount);case 4:return t.next=6,B();case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),b(t.t0);case 11:return t.prev=11,w(!1),t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[0,8,11,14]])})));return function(e){return t.apply(this,arguments)}}(),L=function(){var t=(0,i.Z)(a().mark((function t(r){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,w(!0),t.next=4,e.voteRepoThreshold(n,s,parseInt(r,10));case 4:return t.next=6,B();case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),b(t.t0);case 11:return t.prev=11,w(!1),t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[0,8,11,14]])})));return function(e){return t.apply(this,arguments)}}(),z=function(){var t=(0,i.Z)(a().mark((function t(r){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,w(!0),t.next=4,e.voteRepoDev(n,s,r);case 4:return t.next=6,B();case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),b(t.t0);case 11:return t.prev=11,w(!1),t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[0,8,11,14]])})));return function(e){return t.apply(this,arguments)}}(),Q=function(){var t=(0,i.Z)(a().mark((function t(r){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,w(!0),t.next=4,e.revokeRepoDev(n,s,r);case 4:return t.next=6,B();case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),b(t.t0);case 11:return t.prev=11,w(!1),t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[0,8,11,14]])})));return function(e){return t.apply(this,arguments)}}(),W=function(){var t=(0,i.Z)(a().mark((function t(r){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,w(!0),t.next=4,e.rotateRepoDev(n,s,r);case 4:return t.next=6,B();case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),b(t.t0);case 11:return t.prev=11,w(!1),t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[0,8,11,14]])})));return function(e){return t.apply(this,arguments)}}(),Y=function(){var t=(0,i.Z)(a().mark((function t(r){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,w(!0),t.next=4,e.publishRelease(n,s,r,e.defaultAccount);case 4:return t.next=6,B();case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),b(t.t0);case 11:return t.prev=11,w(!1),t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[0,8,11,14]])})));return function(e){return t.apply(this,arguments)}}(),$=function(){var t=(0,i.Z)(a().mark((function t(r,i,c){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,w(!0),t.next=4,e.clearPendingRepoKey(n,s,i,r,c);case 4:return t.next=6,B();case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),b(t.t0);case 11:return t.prev=11,w(!1),t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[0,8,11,14]])})));return function(e,n,r){return t.apply(this,arguments)}}(),ee=function(){var t=(0,i.Z)(a().mark((function t(r,i){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,w(!0),t.next=4,e.clearPendingRepoThreshold(n,s,parseInt(r,10),i);case 4:return t.next=6,B();case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),b(t.t0);case 11:return t.prev=11,w(!1),t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[0,8,11,14]])})));return function(e,n){return t.apply(this,arguments)}}(),te=function(){var t=(0,i.Z)(a().mark((function t(r,i){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,w(!0),t.next=4,e.clearPendingRelease(n,s,r,i);case 4:return t.next=6,B();case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),b(t.t0);case 11:return t.prev=11,w(!1),t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[0,8,11,14]])})));return function(e,n){return t.apply(this,arguments)}}();return(0,c.useEffect)((function(){G()}),[e,n,s]),(0,r.jsxs)(d.Z,{title:"Valist | Manage Project",children:[(0,r.jsx)("div",{className:"grid grid-cols-1 gap-4 items-start",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-4 lg:col-span-2",children:[(0,r.jsx)("section",{"aria-labelledby":"profile-overview-title"}),(0,r.jsxs)("div",{style:{minHeight:"500px"},className:"rounded-lg bg-white p-10 overflow-hidden shadow",children:[(0,r.jsxs)("div",{className:"text-center text-3xl",children:[(0,r.jsx)(l.default,{href:"/".concat(n),children:n}),(0,r.jsx)("span",{className:"mx-8",children:"/"}),(0,r.jsx)(l.default,{href:"/".concat(n,"/").concat(s),children:s})]}),(0,r.jsx)("div",{className:"flex-grow w-full pt-8 max-w-7xl mx-auto xl:px-8 lg:flex",children:R&&(0,r.jsx)(m,{meta:R.meta,orgName:n,repoName:s,setRepoMeta:J,hasReleased:Z})}),(0,r.jsx)("div",{className:"flex-grow w-full pt-8 max-w-7xl mx-auto xl:px-8 lg:flex",children:R&&(0,r.jsx)(x,{threshold:R.threshold,voteThreshold:L})}),(0,r.jsx)("div",{className:"text-center pt-8",children:(0,r.jsx)("h2",{className:"text-3xl",children:"Multi-factor Votes"})}),(0,r.jsx)("div",{className:"flex-grow w-full pt-8 max-w-7xl mx-auto xl:px-8 lg:flex",children:(0,r.jsx)(v.Z,{pendingKeys:q,pendingThresholds:F,pendingReleases:U,votes:D,grantKey:z,revokeKey:Q,voteThreshold:L,clearPendingKey:$,clearPendingThreshold:ee,clearPendingRelease:te,voteRelease:Y})}),(0,r.jsx)("div",{className:"text-center pt-8",children:(0,r.jsx)("h2",{className:"text-3xl",children:"Manage Access & Permissions"})}),(0,r.jsx)("div",{className:"flex-grow w-full pt-8 max-w-7xl mx-auto xl:px-8 lg:flex",children:(0,r.jsx)(g.Z,{keys:_,rotateKey:W,grantKey:z,revokeKey:Q})})]})]})}),j&&(0,r.jsx)(h.Z,{children:"Loading project..."}),y&&(0,r.jsx)(f.Z,{error:y,close:function(){return b(void 0)}})]})},w=j},57752:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/v/[orgName]/[repoName]/edit",function(){return n(35686)}])}},function(e){e.O(0,[800,486,774,888,179],(function(){return t=57752,e(e.s=t);var t}));var t=e.O();_N_E=t}]);