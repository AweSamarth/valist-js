(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[772],{95013:function(e,t,n){"use strict";n.r(t),n.d(t,{EditOrgPage:function(){return v},default:function(){return w}});var r=n(85893),s=n(809),a=n.n(s),i=n(92447),c=n(67294),l=n(11163),o=n(41664),u=n(14485),d=n(73669),m=function(e){var t=(0,c.useState)(""),n=t[0],s=t[1],a=(0,c.useState)(""),i=a[0],l=a[1];return(0,c.useEffect)((function(){s(e.orgMeta.name),l(e.orgMeta.description)}),[e.orgMeta]),(0,r.jsx)("div",{className:"px-4 py-5 sm:rounded-lg sm:p-6",children:(0,r.jsxs)("div",{className:"md:grid md:grid-cols-3 md:gap-6",children:[(0,r.jsxs)("div",{className:"md:col-span-1",children:[(0,r.jsx)("h3",{className:"text-lg font-medium leading-6 text-gray-900",children:"Metadata"}),(0,r.jsx)("p",{className:"mt-1 text-sm leading-5 text-gray-500",children:"This information will be displayed publicly so be careful what you share."})]}),(0,r.jsx)("div",{className:"mt-5 md:mt-0 md:col-span-2",children:(0,r.jsxs)("form",{className:"grid grid-cols-1 gap-y-6 sm:grid-cols-2 sm:gap-x-8",children:[(0,r.jsxs)("div",{className:"sm:col-span-2",children:[(0,r.jsx)("label",{htmlFor:"OrgFullName",className:"block text-sm font-medium leading-5 text-gray-700",children:"Full Name"}),(0,r.jsx)("div",{className:"mt-1 relative rounded-md shadow-sm",children:(0,r.jsx)("input",{value:n,type:"text",onChange:function(e){return s(e.target.value)},required:!0,id:"OrgFullName",className:"form-input block w-full sm:text-sm sm:leading-5 transition ease-in-out duration-150"})})]}),(0,r.jsxs)("div",{className:"sm:col-span-2",children:[(0,r.jsx)("label",{htmlFor:"OrgDescription",className:"block text-sm font-medium leading-5 text-gray-700",children:"Description"}),(0,r.jsx)("div",{className:"mt-1 relative rounded-md shadow-sm",children:(0,r.jsx)("textarea",{value:i,onChange:function(e){return l(e.target.value)},required:!0,id:"OrgDescription",className:"h-20 form-input block w-full sm:text-sm sm:leading-5 transition ease-in-out duration-150"})})]}),(0,r.jsx)("div",{className:"sm:col-span-2",children:(0,r.jsx)("span",{className:"w-full inline-flex rounded-md shadow-sm",children:(0,r.jsx)("button",{onClick:function(){return e.updateOrgMeta({name:n,description:i})},value:"Submit",type:"button",className:"w-full inline-flex items-center justify-center px-6 py-3 border border-transparent text-base leading-6 font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-500 focus:outline-none focus:border-indigo-700 focus:shadow-outline-indigo active:bg-indigo-700 transition ease-in-out duration-150",children:"Update Metadata"})})})]})})]})})},x=function(e){var t=(0,c.useState)("0"),n=t[0],s=t[1];return(0,c.useEffect)((function(){s("".concat(e.orgThreshold))}),[e.orgThreshold]),(0,r.jsx)("div",{className:"px-4 py-5 sm:rounded-lg sm:p-6",children:(0,r.jsxs)("div",{className:"md:grid md:grid-cols-3 md:gap-6",children:[(0,r.jsxs)("div",{className:"md:col-span-1",children:[(0,r.jsx)("h3",{className:"text-lg font-medium leading-6 text-gray-900",children:"Multi-factor"}),(0,r.jsx)("p",{className:"mt-1 text-sm leading-5 text-gray-500",children:"This sets the amount of votes required to add and remove keys. Three or more members are required to enable multi-factor voting."})]}),(0,r.jsx)("div",{className:"mt-5 md:mt-0 md:col-span-2",children:(0,r.jsxs)("form",{className:"grid grid-cols-1 gap-y-6 sm:grid-cols-2 sm:gap-x-8",children:[(0,r.jsxs)("div",{className:"sm:col-span-2",children:[(0,r.jsx)("label",{htmlFor:"VoteThreshold",className:"block text-sm font-medium leading-5 text-gray-700",children:"Voting Threshold"}),(0,r.jsx)("div",{className:"mt-1 relative rounded-md shadow-sm",children:(0,r.jsx)("input",{value:n,type:"number",onChange:function(e){return s(e.target.value)},required:!0,id:"VoteThreshold",className:"form-input block w-full sm:text-sm sm:leading-5 transition ease-in-out duration-150"})})]}),(0,r.jsx)("div",{className:"sm:col-span-2",children:(0,r.jsx)("span",{className:"w-full inline-flex rounded-md shadow-sm",children:(0,r.jsx)("button",{onClick:function(){return e.voteThreshold(n)},value:"Submit",type:"button",className:"w-full inline-flex items-center justify-center px-6 py-3 border border-transparent text-base leading-6 font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-500 focus:outline-none focus:border-indigo-700 focus:shadow-outline-indigo active:bg-indigo-700 transition ease-in-out duration-150",children:"Update Threshold"})})})]})})]})})},h=n(42727),p=n(19186),f=n(93985),g=n(53142),v=function(){var e=(0,c.useContext)(u.Z),t=(0,l.useRouter)(),n="".concat(t.query.orgName),s=(0,c.useState)(!1),v=s[0],w=s[1],j=(0,c.useState)(),N=j[0],b=j[1],y=(0,c.useState)(),k=y[0],O=y[1],T=(0,c.useState)([]),Z=T[0],M=T[1],S=(0,c.useState)([]),_=S[0],P=S[1],E=(0,c.useState)([]),C=E[0],K=E[1],A=(0,c.useState)([]),q=A[0],F=A[1],V=function(){var t=(0,i.Z)(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Promise.all([e.getOrganization(n).then(O),e.getOrgAdmins(n).then(M),e.getOrgEvents(n).then(P),e.getPendingOrgAdmins(n).then(K),e.getPendingOrgThresholds(n).then(F)]));case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),z=function(){var e=(0,i.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,w(!0),e.next=4,V();case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),b(e.t0);case 9:return e.prev=9,w(!1),e.finish(9);case 12:case"end":return e.stop()}}),e,null,[[0,6,9,12]])})));return function(){return e.apply(this,arguments)}}(),D=function(){var t=(0,i.Z)(a().mark((function t(r){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,w(!0),t.next=4,e.setOrgMeta(n,r,e.defaultAccount);case 4:return t.next=6,V();case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),b(t.t0);case 11:return t.prev=11,w(!1),t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[0,8,11,14]])})));return function(e){return t.apply(this,arguments)}}(),I=function(){var t=(0,i.Z)(a().mark((function t(r){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,w(!0),t.next=4,e.voteOrgThreshold(n,parseInt(r,10));case 4:return t.next=6,V();case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),b(t.t0);case 11:return t.prev=11,w(!1),t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[0,8,11,14]])})));return function(e){return t.apply(this,arguments)}}(),U=function(){var t=(0,i.Z)(a().mark((function t(r){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,w(!0),t.next=4,e.voteOrgAdmin(n,r);case 4:return t.next=6,V();case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),b(t.t0);case 11:return t.prev=11,w(!1),t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[0,8,11,14]])})));return function(e){return t.apply(this,arguments)}}(),X=function(){var t=(0,i.Z)(a().mark((function t(r){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,w(!0),t.next=4,e.revokeOrgAdmin(n,r);case 4:return t.next=6,V();case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),b(t.t0);case 11:return t.prev=11,w(!1),t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[0,8,11,14]])})));return function(e){return t.apply(this,arguments)}}(),H=function(){var t=(0,i.Z)(a().mark((function t(r){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,w(!0),t.next=4,e.rotateOrgAdmin(n,r);case 4:return t.next=6,V();case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),b(t.t0);case 11:return t.prev=11,w(!1),t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[0,8,11,14]])})));return function(e){return t.apply(this,arguments)}}(),L=function(){var t=(0,i.Z)(a().mark((function t(r,s,i){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,w(!0),t.next=4,e.clearPendingOrgKey(n,s,r,i);case 4:return t.next=6,V();case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),b(t.t0);case 11:return t.prev=11,w(!1),t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[0,8,11,14]])})));return function(e,n,r){return t.apply(this,arguments)}}(),R=function(){var t=(0,i.Z)(a().mark((function t(r,s){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,w(!0),t.next=4,e.clearPendingOrgThreshold(n,parseInt(r,10),s);case 4:return t.next=6,V();case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),b(t.t0);case 11:return t.prev=11,w(!1),t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[0,8,11,14]])})));return function(e,n){return t.apply(this,arguments)}}();return(0,c.useEffect)((function(){z()}),[e,n]),(0,r.jsxs)(d.Z,{title:"Valist | Manage Organization",children:[(0,r.jsx)("div",{className:"grid grid-cols-1 gap-4 items-start",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-4 lg:col-span-2",children:[(0,r.jsx)("section",{"aria-labelledby":"profile-overview-title"}),(0,r.jsxs)("div",{style:{minHeight:"500px"},className:"rounded-lg bg-white p-10 overflow-hidden shadow",children:[(0,r.jsx)("div",{className:"text-center text-3xl",children:(0,r.jsx)(o.default,{href:"/".concat(n),children:n})}),(0,r.jsx)("div",{className:"flex-grow w-full pt-8 max-w-7xl mx-auto xl:px-8 lg:flex",children:k&&(0,r.jsx)(m,{orgMeta:k.meta,updateOrgMeta:D})}),(0,r.jsx)("div",{className:"flex-grow w-full pt-8 max-w-7xl mx-auto xl:px-8 lg:flex",children:k&&(0,r.jsx)(x,{orgThreshold:k.threshold,voteThreshold:I})}),(0,r.jsx)("div",{className:"text-center pt-8",children:(0,r.jsx)("h2",{className:"text-3xl",children:"Multi-factor Votes"})}),(0,r.jsx)("div",{className:"flex-grow w-full pt-8 max-w-7xl mx-auto xl:px-8 lg:flex",children:(0,r.jsx)(p.Z,{pendingKeys:C,pendingThresholds:q,votes:_,grantKey:U,revokeKey:X,voteThreshold:I,clearPendingKey:L,clearPendingThreshold:R})}),(0,r.jsx)("div",{className:"text-center pt-8",children:(0,r.jsx)("h2",{className:"text-3xl",children:"Manage Access & Permissions"})}),(0,r.jsx)("div",{className:"flex-grow w-full pt-8 max-w-7xl mx-auto xl:px-8 lg:flex",children:(0,r.jsx)(h.Z,{keys:Z,rotateKey:H,grantKey:U,revokeKey:X})})]})]})}),v&&(0,r.jsx)(f.Z,{children:"Loading organization..."}),N&&(0,r.jsx)(g.Z,{error:N,close:function(){return b(void 0)}})]})},w=v},17808:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/v/[orgName]/edit",function(){return n(95013)}])}},function(e){e.O(0,[800,486,774,888,179],(function(){return t=17808,e(e.s=t);var t}));var t=e.O();_N_E=t}]);